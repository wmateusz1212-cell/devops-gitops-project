apiVersion: v1
kind: Service
metadata:
  name: web-app
spec:
  type: NodePort      # Wystawiamy aplikacjÄ™ na zewnÄ…trz klastra (Å¼ebyÅ› mÃ³gÅ‚ wejÅ›Ä‡ przez przeglÄ…darkÄ™)
  selector:
    app: web-app
  ports:
    - port: 80        # Serwis bÄ™dzie dostÄ™pny na porcie 80
      targetPort: 5000 # Ale ruch przekaÅ¼e do kontenera na port 5000 (bo tak ustawiÅ‚eÅ› we Flasku)

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app
spec:
  replicas: 2         # <--- URUCHAMIAMY 2 KOPIE (PODY)!
  selector:
    matchLabels:
      app: web-app
  template:
    metadata:
      labels:
        app: web-app
    spec:
      containers:
        - name: web-app
          # ğŸ‘‡ğŸ‘‡ğŸ‘‡ PODMIEÅƒ 'TWOJ_LOGIN' NA SWÃ“J LOGIN Z DOCKER HUB ğŸ‘‡ğŸ‘‡ğŸ‘‡
          image: wmateusz1212/devops-project:latest
          # ğŸ‘†ğŸ‘†ğŸ‘† Np. wmateusz1212/devops-project:latest
          imagePullPolicy: Always # Zawsze pobieraj najnowszÄ… wersjÄ™ z sieci
          ports:
            - containerPort: 5000
          env:
            - name: REDIS_HOST # MoÅ¼emy przekazaÄ‡ zmiennÄ… Å›rodowiskowÄ… (opcjonalnie)
              value: "redis"
